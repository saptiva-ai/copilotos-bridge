# ========================================
# PRODUCCIÓN - COPILOTOS BRIDGE API
# ========================================

# Server Configuration
HOST=0.0.0.0
PORT=8001
DEBUG=false
RELOAD=false

# Application
APP_NAME=CopilotOS Bridge API
APP_VERSION=0.1.0
APP_DESCRIPTION=Production API for chat and deep research using Aletheia orchestrator

# Database (MongoDB) - Configuración de producción
# MONGODB_URL debe apuntar a cluster de producción
MONGODB_URL=mongodb+srv://prod_user:${MONGODB_PASSWORD}@cluster.mongodb.net/copilotos_prod?retryWrites=true&w=majority
DB_MIN_POOL_SIZE=10
DB_MAX_POOL_SIZE=100
DB_CONNECTION_TIMEOUT_MS=5000
DB_SERVER_SELECTION_TIMEOUT_MS=5000

# Redis - Configuración de producción
# REDIS_URL debe apuntar a instancia de producción
REDIS_URL=redis://:${REDIS_PASSWORD}@prod-redis:6379/0
REDIS_POOL_SIZE=20
REDIS_CONNECTION_TIMEOUT=5
REDIS_SOCKET_KEEPALIVE=true

# Authentication - Tokens seguros
JWT_SECRET_KEY=${JWT_SECRET_KEY}
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# Aletheia Integration - Servicio de producción
ALETHEIA_BASE_URL=${ALETHEIA_BASE_URL}
ALETHEIA_API_KEY=${ALETHEIA_API_KEY}
ALETHEIA_TIMEOUT=180
ALETHEIA_MAX_RETRIES=5
ALETHEIA_RETRY_BACKOFF=2.0

# SAPTIVA Integration - API de producción
SAPTIVA_BASE_URL=https://api.saptiva.com
SAPTIVA_API_KEY=${SAPTIVA_API_KEY}
SAPTIVA_TIMEOUT=60
SAPTIVA_MAX_RETRIES=5
SAPTIVA_RETRY_BACKOFF=1.5

# Rate Limiting - Protección en producción
RATE_LIMIT_ENABLED=true
RATE_LIMIT_CALLS=100
RATE_LIMIT_PERIOD=60
RATE_LIMIT_REDIS_PREFIX=copilotos_rate_limit
RATE_LIMIT_STRATEGY=sliding_window

# CORS - Dominios de producción
CORS_ORIGINS=["https://app.copilotos.com", "https://copilotos.com", "https://www.copilotos.com"]
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["GET", "POST", "PUT", "DELETE", "OPTIONS"]
CORS_ALLOW_HEADERS=["*"]

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_STRUCTURED=true

# OpenTelemetry - Monitoreo de producción
OTEL_SERVICE_NAME=copilotos-api-prod
OTEL_SERVICE_VERSION=0.1.0
OTEL_EXPORTER_OTLP_ENDPOINT=${OTEL_ENDPOINT}
OTEL_EXPORTER_OTLP_HEADERS=api-key=${OTEL_API_KEY}
OTEL_RESOURCE_ATTRIBUTES=service.name=copilotos-api,service.version=0.1.0,deployment.environment=production

# Security - Configuración segura
SECURE_COOKIES=true
HTTPS_ONLY=true
SECRET_KEY=${SECRET_KEY}
ALLOWED_HOSTS=["app.copilotos.com", "api.copilotos.com"]
CSRF_TRUSTED_ORIGINS=["https://app.copilotos.com", "https://copilotos.com"]

# File Upload - Límites de producción
MAX_FILE_SIZE=52428800  # 50MB
ALLOWED_FILE_TYPES=["txt", "md", "pdf", "docx", "xlsx", "csv"]
UPLOAD_SECURITY_SCAN=true

# Background Tasks - Redis como broker
CELERY_BROKER_URL=redis://:${REDIS_PASSWORD}@prod-redis:6379/1
CELERY_RESULT_BACKEND=redis://:${REDIS_PASSWORD}@prod-redis:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true

# Health Checks
HEALTH_CHECK_TIMEOUT=30
HEALTH_CHECK_INTERVAL=60
ENABLE_HEALTH_CHECKS=true

# Performance
WORKER_CONNECTIONS=1000
WORKER_CLASS=uvicorn.workers.UvicornWorker
WORKERS=4
KEEP_ALIVE=2
MAX_REQUESTS=1000
MAX_REQUESTS_JITTER=100

# Backup and Recovery
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30

# Feature Flags
FEATURE_ADVANCED_RESEARCH=true
FEATURE_FILE_UPLOAD=true
FEATURE_STREAMING=true
FEATURE_CHAT_HISTORY=true
FEATURE_USER_ANALYTICS=true

# Production flags
DEV_MODE=false
USE_MEMORY_DB=false
SKIP_DB_CHECKS=false
MOCK_ALETHEIA=false
ENABLE_PROMETHEUS=true
ENABLE_HEALTH_ENDPOINT=true

# Cache Configuration
CACHE_TTL_SECONDS=3600
CACHE_MAX_SIZE=1000
ENABLE_RESPONSE_CACHE=true

# Email Configuration (for notifications)
SMTP_HOST=${SMTP_HOST}
SMTP_PORT=587
SMTP_USER=${SMTP_USER}
SMTP_PASSWORD=${SMTP_PASSWORD}
SMTP_TLS=true
FROM_EMAIL=noreply@copilotos.com

# Error Tracking
SENTRY_DSN=${SENTRY_DSN}
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# API Documentation
DOCS_URL=/docs
REDOC_URL=/redoc
OPENAPI_URL=/openapi.json
DOCS_ENABLED=true